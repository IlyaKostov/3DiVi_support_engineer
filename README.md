# Описание
Утилита quality_scan предназначена для расчета качества массива фотографий.  
Качество вычисляется применительно к требованиям международных стандартов ISO/IEC 19794-5,
ГОСТ Р ИСО/МЭК 19794-5.

| Параметр               | Пояснение                                            |
|------------------------|------------------------------------------------------|
| Confidence             | Уверенность детектора лиц, от 0.0 до 1.0            |
| totalScore             | Обобщенная оценка качества изображения лица          |
| isSharp                | Резкость изображения, 0 - нерезкое, 1 - резкое      |
| sharpnessScore         | Уровень резкости, 0 - минимальная, 100 - максимальная|
| isEvenlyIlluminated    | Равномерность освещения, 0 - неравномерное, 1 - равномерное|
| illuminationScore      | Уровень равномерности освещения, 0 - минимальный, 100 - максимальный|
| noFlare                | Отсутствие бликов на лице, 1 - нет бликов, 0 - есть блики|
| isLeftEyeOpened        | Открытость левого глаза, 0 - глаз закрыт, 1 - глаз открыт|
| isRightEyeOpened       | Открытость правого глаза, 0 - глаз закрыт, 1 - глаз открыт|
| isRotationAcceptable   | Допустимость углов наклона/поворота, 1 - допустимо, 0 - вне допусков|
| notMasked              | Наличие перекрытий, 1 - перекрытий нет, 0 - перекрытия есть|
| isNeutralEmotion       | Нейтральное выражение лица, 1 - нейтральное, 0 - присутствуют эмоции|
| isEyesDistanceAcceptable| Дистанция между глазами в пикселах, 1 - не менее 60 пикселов, 0 - менее 60 пикселов|
| eyesDistance           | Дистанция между глазами в пикселах, количество пикселов|
| isMarginsAcceptable    | Наличие расстояния от лица до границ изображения, 1 - достаточное, 0 - недостаточное|
| isNotNoisy             | Наличие шума на изображении, 1 - нет, 0 - есть|
| hasWatermark           | Наличие водяных знаков на изображении, 1 - присутствуют, 0 - нет|
| dynamicRangeScore      | Динамический диапазон изображения, 0 - минимальный, 255 - максимальный|
| isDynamicRangeAcceptable| Допустимый динамический диапазон, 1 - достаточный, 0 - недостаточный|

## Функционал
При запуске утилиты необходимо указать путь к каталогу с фотографиями в качестве
аргумента используя параметр --images_dir.  
Дополнительно, можно ограничить количество фотографий используя
параметр --num_processed количество_фотографий, в этом случае программа
выберет случайным образом заданное количество фотографий для обработки.  
Так же обязательно требуется указать путь к папке с 3DiVi Face SDK, используя параметр --sdk_path.   
Утилита создает папку с результатами, с файлом в формате csv.  
Так же добавлен progress bar, отражающий прогресс выполнения.

Реализован дополнительный скрипт для создания гистограммы на основе значений totalScore из таблицы result.csv в формате png.

## Запуск

1. **Клонируйте репозиторий**
    ```bash
    git clone "ссылка на репозиторий"
    ```
2. **Установите и активируйте виртуальное окружение**
    ```bash
    python -m venv env
    ```
    На Windows
    ```bash
    .\env\Scripts\activate
    ```
    на Linux
    ```bash
    ./env/bin/activate
    ```
3. **Установите 3DiVi Face SDK, следуя [инструкциям](https://docs.3divi.ai/face_sdk/ru/getting_started/)**
  

4. **Установите зависимости**
    ```bash
    pip install -r requirements.txt
    ```
    Для установки пакета face_sdk_3divi следуйте [инструкциям](https://docs.3divi.ai/face_sdk/ru/development/dev_connecting_fsdk_to_project#python)
  

5. **Запустите программу через консоль**
    ```bash
    python main.py --images_dir /path/to/images --sdk_path /path/to/3divi_FaceSDK --num_processed 10 --modification assessment
    ```
    --images_dir /path/to/images - (обязательно) путь к каталогу с фотографиями  
    --sdk_path /path/to/3divi_FaceSDK - (обязательно) путь к директории с 3DiVi Face SDK  
    --num_processed 10 - (опционально) количество фотографий для обработки(выбираются случайно). По умолчанию: Все фотою  
    --modification assessment - (опционально) Спецификация выходного контейнера Context: 'assessment' или 'estimation'. 
    По умолчанию: 'assessment'.
  
6. **Создание гистограммы**
    ```bash
    python generate_histogram.py
    ```

### Стек
- Python 3.12
- 3DiVi Face SDK 3.22.0
- pandas 2.2.2
- alive_progress 3.1.5
- matplotlib 3.9.0
